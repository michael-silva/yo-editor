<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../polymer/lib/elements/dom-if.html">
<link rel="import" href="../yo-image/yo-image.html">
<link rel="import" href="../yo-link/yo-link.html">
<link rel="import" href="../paper-input/paper-input.html">

<dom-module id="yo-editor-item">
    <template>
        <style>
            :host {
                display: block;
            }

            #image {
                max-width: 100%;
            }
        </style>
        <template is="dom-if" if="{{_showText}}">
            <paper-input value="[[text]]" label="Text"></paper-input>
        </template>
        <template is="dom-if" if="{{_showLink}}">
            <yo-link url-value="[[url]]" text-value="[[text]]"></yo-link>
        </template>
        <template is="dom-if" if="{{_showImage}}">
            <img id="image" src$="[[src]]" on-load="_setTarget">
            <yo-image id="yo-image"></yo-image>        
        </template>
    </template>

    <script>
        /**
         * `yo-editor-item`
         * An generic html elements editor
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class YoEditorItem extends Polymer.Element {
            static get is() { return 'yo-editor-item'; }
            static get properties() {
                return {
                    text: {
                        type: String
                    },
                    url: {
                        type: String
                    },
                    src: {
                        type: String
                    }
                };
            }

            _setTarget(e) {
                const yoImage = this.root.querySelector('yo-image');
                yoImage.target = e.target;
            }

            _defineShowVars() {
                this._showLink = this.text && !this.url;
                this._showImage = !!this.src;
                this._showText = !!this.url;
            }

            constructor() {
                super();
                console.log('constructor', this.src, this.url, this.text);
            }

            connectedCallback() {
                super.connectedCallback();
                console.log('connectedCallback', this.root.querySelector('#image'));
            }

            ready() {
                super.ready();
                console.log('ready')
                this._defineShowVars()
            }
        }

        window.customElements.define(YoEditorItem.is, YoEditorItem);
    </script>
</dom-module>